<html>

<head>
  <title>mapOL</title>
  <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css"
    type="text/css">
  <style>
    body {
      background-color: grey;
      text-align: center;
    }

    .map {
      margin: 0 auto;
      width: 75%;
      height: 50%;
    }

    button {
      margin-top: 50px;
    }
  </style>
</head>

<body>
  <div id="map" class="map"></div>
  <div class="btn"><button>Update Location</button></div>
  <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
  <script>
    var latitude;
    var longitude;
    const button = document.querySelector("button");

    var attribution = new ol.control.Attribution({
      collapsible: false
    });

    var map = new ol.Map({
      controls: ol.control.defaults({ attribution: false }).extend([attribution]),
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM({
            url: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png',
            maxZoom: 18
          })
        })
      ],
      target: 'map',
      view: new ol.View({
        center: ol.proj.fromLonLat([79.566427, 22.883021]),
        maxZoom: 18,
        zoom: 1
      })
    });

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showLoc, err);
      }
   
      function showLoc(position) {
      latitude = position.coords.latitude;
      longitude = position.coords.longitude;

      console.log(latitude, longitude);

      var layer = new ol.layer.Vector({
        source: new ol.source.Vector({
          features: [
            new ol.Feature({
              geometry: new ol.geom.Point(ol.proj.fromLonLat([longitude,latitude])),
              zoom: 7
            })
          ]
        })
      });
      map.addLayer(layer);
    }
    function err(error) {
      if (error.code == 1) {
        alert("Something went wrong/ Permission Not Granted");
      }
      else if (error.code == 2) {
        alert("Position Unavailable / Internal Error");
      }
      else if (error.code == 3) {
        alert("Timeout Error");
      }
    }
   
    button.addEventListener("click", () => {
        window.location.reload();
      }
    );
  </script>
</body>

</html>
